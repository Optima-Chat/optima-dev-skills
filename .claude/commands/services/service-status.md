# /service-status - æŸ¥çœ‹æœåŠ¡çŠ¶æ€

æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºã€‚

## ä½¿ç”¨åœºæ™¯

**æ‰€æœ‰å¼€å‘è€…**: å¿«é€Ÿäº†è§£å½“å‰ç¯å¢ƒæ‰€æœ‰æœåŠ¡çš„è¿è¡ŒçŠ¶æ€
**DevOps**: ç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€ï¼Œå‘ç°å¼‚å¸¸æœåŠ¡
**è°ƒè¯•**: æ’æŸ¥æœåŠ¡é—´ä¾èµ–é—®é¢˜

## ç”¨æ³•

/service-status [environment]

## å‚æ•°

- `environment` (å¯é€‰): ç¯å¢ƒ
  - `local` - æœ¬åœ° Docker ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
  - `stage` - Stage-ECS ç¯å¢ƒ
  - `prod` - ç”Ÿäº§ç¯å¢ƒ
  - `all` - æ‰€æœ‰ç¯å¢ƒå¯¹æ¯”

## æ‰§è¡Œé€»è¾‘

1. è¯†åˆ«ç›®æ ‡ç¯å¢ƒ
2. å¹¶å‘æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
3. æ”¶é›†å…³é”®æŒ‡æ ‡ï¼ˆè¿è¡ŒçŠ¶æ€ã€ç«¯å£ã€å¥åº·æ£€æŸ¥ã€èµ„æºä½¿ç”¨ï¼‰
4. ä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºç»“æœ
5. é«˜äº®å¼‚å¸¸æœåŠ¡

## å‘½ä»¤ç¤ºä¾‹

### æœ¬åœ°ç¯å¢ƒ - Docker Compose

```bash
# æ£€æŸ¥ Docker å®¹å™¨çŠ¶æ€
docker compose ps --format json

# æ£€æŸ¥æœåŠ¡å¥åº·
curl -s -o /dev/null -w "%{http_code}" http://localhost:8280/health  # commerce-backend
curl -s -o /dev/null -w "%{http_code}" http://localhost:8290/health  # user-auth
curl -s -o /dev/null -w "%{http_code}" http://localhost:8300/health  # mcp-host

# æ£€æŸ¥æ•°æ®åº“
pg_isready -h localhost -p 8282 -U commerce_user

# æ£€æŸ¥ Redis
redis-cli -h localhost -p 8285 ping

# æ£€æŸ¥ MinIO
curl -s -o /dev/null -w "%{http_code}" http://localhost:8284/minio/health/live
```

### Stage-ECS

```bash
# è·å– ECS æœåŠ¡çŠ¶æ€
aws ecs describe-services \
  --cluster optima-stage \
  --services commerce-backend-stage user-auth-stage mcp-host-stage

# æ£€æŸ¥å¥åº·ç«¯ç‚¹
curl -s -o /dev/null -w "%{http_code}" https://api.stage.optima.onl/health
curl -s -o /dev/null -w "%{http_code}" https://auth.stage.optima.onl/health
curl -s -o /dev/null -w "%{http_code}" https://mcp.stage.optima.onl/health

# æ£€æŸ¥ RDS
aws rds describe-db-instances --db-instance-identifier optima-stage-postgres
```

### Prod

```bash
# é€šè¿‡ SSH æ£€æŸ¥ Docker å®¹å™¨
ssh -i ~/.ssh/optima-ec2-key ec2-user@ec2-prod.optima.shop \
  "docker ps --format '{{.Names}}\t{{.Status}}'"

# æ£€æŸ¥å¥åº·ç«¯ç‚¹
curl -s -o /dev/null -w "%{http_code}" https://api.optima.shop/health
curl -s -o /dev/null -w "%{http_code}" https://auth.optima.shop/health
curl -s -o /dev/null -w "%{http_code}" https://mcp.optima.shop/health

# æ£€æŸ¥ RDS
aws rds describe-db-instances --db-instance-identifier optima-prod-postgres
```

## é¢„æœŸè¾“å‡º

### æœ¬åœ°ç¯å¢ƒï¼ˆå…¨éƒ¨æ­£å¸¸ï¼‰

```
ğŸ“Š æœåŠ¡çŠ¶æ€æŠ¥å‘Š - æœ¬åœ°ç¯å¢ƒ (local)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœåŠ¡                â”‚ çŠ¶æ€     â”‚ ç«¯å£   â”‚ å¥åº·æ£€æŸ¥   â”‚ å¯åŠ¨æ—¶é—´    â”‚ CPU/å†…å­˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ commerce-backend    â”‚ âœ… è¿è¡Œ  â”‚ 8280   â”‚ âœ… 200 OK  â”‚ 2å°æ—¶å‰     â”‚ 5%/120MB â”‚
â”‚ user-auth           â”‚ âœ… è¿è¡Œ  â”‚ 8290   â”‚ âœ… 200 OK  â”‚ 2å°æ—¶å‰     â”‚ 3%/80MB  â”‚
â”‚ mcp-host            â”‚ âœ… è¿è¡Œ  â”‚ 8300   â”‚ âœ… 200 OK  â”‚ 2å°æ—¶å‰     â”‚ 4%/100MB â”‚
â”‚ postgres            â”‚ âœ… è¿è¡Œ  â”‚ 8282   â”‚ âœ… å°±ç»ª    â”‚ 3å°æ—¶å‰     â”‚ 2%/150MB â”‚
â”‚ redis               â”‚ âœ… è¿è¡Œ  â”‚ 8285   â”‚ âœ… PONG    â”‚ 3å°æ—¶å‰     â”‚ 1%/30MB  â”‚
â”‚ minio               â”‚ âœ… è¿è¡Œ  â”‚ 8283/4 â”‚ âœ… 200 OK  â”‚ 3å°æ—¶å‰     â”‚ 1%/50MB  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š æ€»è§ˆ:
âœ… è¿è¡Œä¸­: 6/6
âš ï¸ è­¦å‘Š: 0
âŒ å¼‚å¸¸: 0

ğŸŒ è®¿é—®åœ°å€:
â€¢ Commerce Backend: http://localhost:8280/docs
â€¢ User Auth: http://localhost:8290/docs
â€¢ MCP Host: http://localhost:8300/docs
â€¢ MinIO Console: http://localhost:8284
```

### æœ¬åœ°ç¯å¢ƒï¼ˆéƒ¨åˆ†å¼‚å¸¸ï¼‰

```
ğŸ“Š æœåŠ¡çŠ¶æ€æŠ¥å‘Š - æœ¬åœ°ç¯å¢ƒ (local)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœåŠ¡                â”‚ çŠ¶æ€     â”‚ ç«¯å£   â”‚ å¥åº·æ£€æŸ¥   â”‚ å¯åŠ¨æ—¶é—´    â”‚ CPU/å†…å­˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ commerce-backend    â”‚ âœ… è¿è¡Œ  â”‚ 8280   â”‚ âœ… 200 OK  â”‚ 10åˆ†é’Ÿå‰    â”‚ 5%/120MB â”‚
â”‚ user-auth           â”‚ âŒ åœæ­¢  â”‚ -      â”‚ âŒ ä¸å¯ç”¨  â”‚ -           â”‚ -        â”‚
â”‚ mcp-host            â”‚ âš ï¸ ä¸å¥åº·â”‚ 8300   â”‚ âŒ 503     â”‚ 1å°æ—¶å‰     â”‚ 45%/500MBâ”‚
â”‚ postgres            â”‚ âœ… è¿è¡Œ  â”‚ 8282   â”‚ âœ… å°±ç»ª    â”‚ 2å°æ—¶å‰     â”‚ 2%/150MB â”‚
â”‚ redis               â”‚ âœ… è¿è¡Œ  â”‚ 8285   â”‚ âœ… PONG    â”‚ 2å°æ—¶å‰     â”‚ 1%/30MB  â”‚
â”‚ minio               â”‚ âœ… è¿è¡Œ  â”‚ 8283/4 â”‚ âœ… 200 OK  â”‚ 2å°æ—¶å‰     â”‚ 1%/50MB  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š æ€»è§ˆ:
âœ… è¿è¡Œä¸­: 4/6
âš ï¸ è­¦å‘Š: 1/6 (mcp-host)
âŒ å¼‚å¸¸: 1/6 (user-auth)

âš ï¸ éœ€è¦å¤„ç†çš„é—®é¢˜:

1. âŒ user-auth å·²åœæ­¢
   åŸå› : å®¹å™¨æœªè¿è¡Œ
   å»ºè®®: /restart-service user-auth

2. âš ï¸ mcp-host ä¸å¥åº· (HTTP 503)
   åŸå› : æœåŠ¡å¯åŠ¨ä½†å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œå†…å­˜ä½¿ç”¨è¿‡é«˜ (500MB)
   å»ºè®®:
   - æŸ¥çœ‹æ—¥å¿—: /logs mcp-host
   - é‡å¯æœåŠ¡: /restart-service mcp-host
   - æ£€æŸ¥ MCP æœåŠ¡å™¨è¿æ¥
```

### Stage-ECS ç¯å¢ƒ

```
ğŸ“Š æœåŠ¡çŠ¶æ€æŠ¥å‘Š - Stage-ECS (stage)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœåŠ¡                    â”‚ çŠ¶æ€     â”‚ ä»»åŠ¡æ•°       â”‚ å¥åº·æ£€æŸ¥   â”‚ æœ€åéƒ¨ç½²    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ commerce-backend-stage  â”‚ âœ… è¿è¡Œ  â”‚ 2/2 (ç¨³å®š)   â”‚ âœ… 200 OK  â”‚ 3å¤©å‰       â”‚
â”‚ user-auth-stage         â”‚ âœ… è¿è¡Œ  â”‚ 1/1 (ç¨³å®š)   â”‚ âœ… 200 OK  â”‚ 5å¤©å‰       â”‚
â”‚ mcp-host-stage          â”‚ âœ… è¿è¡Œ  â”‚ 1/1 (ç¨³å®š)   â”‚ âœ… 200 OK  â”‚ 2å¤©å‰       â”‚
â”‚ optima-stage-postgres   â”‚ âœ… è¿è¡Œ  â”‚ -            â”‚ âœ… å¯ç”¨    â”‚ -           â”‚
â”‚ optima-stage-redis      â”‚ âœ… è¿è¡Œ  â”‚ -            â”‚ âœ… å¯ç”¨    â”‚ -           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š æ€»è§ˆ: 5/5 æœåŠ¡æ­£å¸¸

ğŸŒ è®¿é—®åœ°å€:
â€¢ Commerce Backend: https://api.stage.optima.onl
â€¢ User Auth: https://auth.stage.optima.onl
â€¢ MCP Host: https://mcp.stage.optima.onl
```

### æ‰€æœ‰ç¯å¢ƒå¯¹æ¯”

```
ğŸ“Š æœåŠ¡çŠ¶æ€æŠ¥å‘Š - æ‰€æœ‰ç¯å¢ƒå¯¹æ¯”

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœåŠ¡              â”‚ Local        â”‚ Stage        â”‚ Prod         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ commerce-backend  â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚
â”‚ user-auth         â”‚ âŒ åœæ­¢      â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚
â”‚ mcp-host          â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚
â”‚ postgres          â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚
â”‚ redis             â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚ âœ… è¿è¡Œ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ ç¯å¢ƒå·®å¼‚:
- Local çš„ user-auth å·²åœæ­¢ï¼Œéœ€è¦é‡å¯
```

## æ‰©å±•æ£€æŸ¥é¡¹

### åŒ…å«å‰ç«¯åº”ç”¨

```bash
# æ£€æŸ¥ optima-store (å‰ç«¯)
curl -s -o /dev/null -w "%{http_code}" http://localhost:3001

# æ£€æŸ¥ agentic-chat (å‰ç«¯)
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000
```

### åŒ…å« MCP å·¥å…·æœåŠ¡

```bash
# æ£€æŸ¥ Commerce MCP
curl -s -o /dev/null -w "%{http_code}" http://localhost:8230/health

# æ£€æŸ¥ Scout MCP
curl -s -o /dev/null -w "%{http_code}" http://localhost:8250/health

# æ£€æŸ¥ Comfy MCP
curl -s -o /dev/null -w "%{http_code}" http://localhost:8220/health

# æ£€æŸ¥ Google Ads MCP
curl -s -o /dev/null -w "%{http_code}" http://localhost:8240/health
```

## æ•…éšœæ’æŸ¥

### Docker å®¹å™¨æœªè¿è¡Œ

```
Error: No such container
```

- å¯åŠ¨ Docker Compose: `docker compose up -d`
- æ£€æŸ¥ docker-compose.yml é…ç½®

### AWS å‡­è¯é—®é¢˜

```
Error: Unable to locate credentials
```

- é…ç½® AWS CLI: `aws configure`
- æˆ–è®¾ç½®ç¯å¢ƒå˜é‡: `AWS_PROFILE=optima`

### SSH è¿æ¥å¤±è´¥

```
Error: Permission denied
```

- æ£€æŸ¥ SSH å¯†é’¥: `chmod 600 ~/.ssh/optima-ec2-key`
- éªŒè¯ EC2 ä¸»æœºåœ°å€

## ç›¸å…³å‘½ä»¤

- /health-check - è¯¦ç»†å¥åº·æ£€æŸ¥
- /logs - æŸ¥çœ‹æœåŠ¡æ—¥å¿—
- /restart-service - é‡å¯å¼‚å¸¸æœåŠ¡
